---
rip: 9999
title: RIP-7560 Transaction Subtypes providing extended features for EOAs
description: A set of RIP-7560 Transaction Subtypes that each extend the existing functionality of Externally Owned Accounts and improve overall experience for the users
author: Yoav Weiss (@yoavw), Alex Forshtat (@forshtat), Dror Tirosh (@drortirosh), Shahaf Nacson (@shahafn)
discussions-to:
status: Draft
type: Standards Track
category: Core
created:
requires: 7560
---

## Abstract

## Motivation

## Specification

### Gas-sponsored time-limited EOA transaction subtype

```
SPONSORED_EOA_SUBTYPE = x
```

This transaction subtype allows replacing a Smart Contract Account validation with a more familiar ECDSA validation
pattern used in existing transaction types 0, 1 and 2.

However, it retains the ability of an RIP-7560 transaction to include Paymaster data in order for the Paymaster
contract to accept the gas charges. It also retains an ability to explicitly specify a time range where this
transaction is valid, creating both "expiring" and "delayed" transactions.

In case the `to` field is `nil`, `callData` is treated as `initCode` for the purpose of contract creation.

https://eips.ethereum.org/EIPS/eip-2711

### Gas-sponsored time-limited batched execution EOA transaction subtype

```
BATCHED_EOA_SUBTYPE = x
```

This transaction subtype extends the `SPONSORED_EOA_SUBTYPE` transactions with an ability to initialize multiple
EOA calls with a single signature and a single Paymaster validation.

Fields `to` and `callData` are replaced with fields `targets` and `callDatas` containing RLP encoded arrays of values.

The field `atomicity` contains an RLP encoded array of `byte` "atomicity" values.
Atomicity describes a behaviour in case of a top-level revert in one of the frames, and can take the following values:

* `CONTINUE_ON_REVERT = 0` - ignores the reverted execution and continues executing the batch
* `TERMINATE_ON_REVERT = 1` - stops the execution of the batch on the reverted execution, does not execute the remainder
* `ROLLBACK_ON_REVERT = 2` - rolls back all state changes caused by all the execution frames in current transaction

https://eips.ethereum.org/EIPS/eip-2711

### Gas-sponsored time-limited one-time delegated EOA transaction subtype

```
DELEGATED_EOA_SUBTYPE = x
```

This transaction subtype extends the `SPONSORED_EOA_SUBTYPE` transactions with an ability to execute arbitrary
contract code in the context of the EOA sender.

Note that such transaction provides a one-time signature delegating execution to the `destination` contract,
and this signature cannot be used repeatedly. The private key of the EOA will be needed to sign consequent delegations.

TODO: Opcode restrictions (SSTORE, CREATE, CREATE2)
See https://eips.ethereum.org/EIPS/eip-5806

### Gas-sponsored time-limited reusable authorization EOA transaction subtype

```
AUTHORIZED_EOA_SUBTYPE = x
```

This transaction subtype extends the `DELEGATED_EOA_SUBTYPE` transactions with an ability to authorize arbitrary
contract code to control the context of the EOA sender.

The transaction signature (`yParity`, `r`, `s`) are interpreted as an ECDSA signature on the `secp256k1` curve over
the message `keccak256(MAGIC || chainId || nonce || invokerAddress || commit)`.

Note that account's `nonce` is not incremented when `AUTHORIZED_EOA_SUBTYPE` transaction is executed so the same
authorization can be used unlimited number of times. In order to withdraw authorization, the account must perform
any action that will increment its nonce.

Transaction hash uniqueness is therefore not guaranteed by a nonce field, therefore must be explicitly be a requirement
for a transaction validity:

```
AUTHORIZED_EOA_SUBTYPE is not valid if a transaction with identical hash has alredy been included in the current chain
```

Note that Paymaster Data is not signed, so different Paymaster contracts can be used for subsequent
authorized transactions.

[//]: # (TODO: we need to provide `commitment` bytes to the invoker for validation, this function is one way to do it)

We then define the following Solidity method and the `invokerAddress` of the transaction is invoked with the
corresponding data:

```solidity

    function executeAuthorizedTransaction(uint256 version, bytes32 txHash, bytes transaction) external;

```

#### Using permanent authorizations to create Smart Contract Accounts

This approach relies on the so-called "Nick's method", which includes deriving an address from some data and
a randomized signature value, without ever knowing the ECDSA private key that would be able to control this address.

Applying this approach to an `AUTHORIZED_EOA_SUBTYPE` transaction, a new account can be created,
whose address is forever bound to `invokerAddress` and `commit`, without ever needing to deploy code for the contract.

https://eips.ethereum.org/EIPS/eip-3074

### Gas-sponsored time-limited code injection EOA transaction subtype

```
INSERT_CODE_EOA_SUBTYPE
```

This transaction subtype extends the `SPONSORED_EOA_SUBTYPE` transactions with an ability to insert
contract code in the context of the EOA sender.

https://eips.ethereum.org/EIPS/eip-7377

## Rationale

## Backwards Compatibility

## Security Considerations

## Copyright

Copyright and related rights waived via [CC0](../LICENSE.md).
